var ContentType = require( '../content_types' ).ContentType;
var StatusCode = require( '../status_codes' ).StatusCode;
var Resource = require( './resource' ).Resource;
var inherits = require( 'util' ).inherits;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

function LibraryResource() {
   this.constructor.super_.apply( this, arguments );
   return this;
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

inherits( LibraryResource, Resource );

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

LibraryResource.CONTENT_TYPE = ContentType.Library;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

LibraryResource.handleIndex = function( context, callback ) {
   // The library is a virtual resource, of which we only have one. Redirect to that.
   context.response.redirect( context.address.libraries.show( { entityID: '0' } ) );
};

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

LibraryResource.prototype.linkify = function( library, callback ) {
   
   library.links = [
      { rel: 'songs', url: this._context.address.songs.index }
   ];
   
   callback( null, library );
};

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

LibraryResource.handleShow = function( context, id, callback ) {
   // Virtual resource
   new LibraryResource( context, { value: {} } ).createResponse( StatusCode.Ok, callback );
};

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

exports.LibraryResource = LibraryResource;