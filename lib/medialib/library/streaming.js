var fs = require( 'fs' );
var addressable = require( 'addressable' );
var util = require( 'util' );

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

var fileStreamer = {
   open: function( address ) {
      return fs.createReadStream( address.path );
   }
};

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

function MediaStreaming() {
   
   this.streamers = {
      file: fileStreamer
   };
   
   return this;
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

MediaStreaming.prototype.open = function( url, callback ) {

   var address = addressable.parse( url );

   var streamer = this.findStreamerForScheme( address.scheme );
   
   callback( null, streamer.open( address ) );
};

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

/**
 * @private 
 */
MediaStreaming.prototype.findStreamerForScheme = function ( address ) {
   return this.streamers[ scheme ];
};

//////////////////////////////////////////////////////////////////////////////////////////////////////////////

exports = new MediaStreaming();
